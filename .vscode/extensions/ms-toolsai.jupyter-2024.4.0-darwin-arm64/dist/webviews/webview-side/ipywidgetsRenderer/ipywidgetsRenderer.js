function P(t){if(typeof document!="undefined"){var r=document.createElement("style"),o=document.createTextNode(t);r.appendChild(o),document.head.appendChild(r)}}var T=`.cell-output-ipywidget-background{background:white!important}
`;P(T);var k=Symbol("MicrotaskDelay");var h=class{constructor(r=null){this.scope=r;this._resolved=!1;this._rejected=!1;this._promise=new Promise((o,s)=>{this._resolve=o,this._reject=s})}get value(){return this._value}resolve(r){this._value=r,this._resolve.apply(this.scope?this.scope:this,arguments),this._resolved=!0}reject(r){this._reject.apply(this.scope?this.scope:this,arguments),this._rejected=!0}get promise(){return this._promise}get resolved(){return this._resolved}get rejected(){return this._rejected}get completed(){return this._rejected||this._resolved}};function y(t=null){return new h(t)}var v;function w(t){v&&v("error",t)}function _(t){return t.mime.toLowerCase().includes("json")?t.json():t.text()}var l=class extends Error{constructor(){super(),this.name="vscode.fallbackToNextRenderer"}};async function I(){return new Promise(r=>{let o=()=>{var u,e;let s=((u=window.ipywidgetsKernel)==null?void 0:u.renderOutput)||((e=this.ipywidgetsKernel)==null?void 0:e.renderOutput);s?(window.ipywidgetsKernel.initialize(),r(s)):setTimeout(o,100)};o()})}var B=t=>{let r=(e,i)=>{t.postMessage&&t.postMessage({command:"log",message:e,category:i}),i==="error"&&console.error(e)};r("Jupyter IPyWidget Renderer Activated"),D(t);let o=new Map,s=y();t.postMessage&&t.postMessage({command:"ipywidget-renderer-loaded"}),t.onDidReceiveMessage&&t.onDidReceiveMessage(async e=>{var i;if(e.command==="query-widget-state"&&e.model_id&&((i=o.get(e.model_id))==null||i.resolve(e),o.delete(e.model_id)),e.command==="ipywidget-renderer-init"){let d=window.ipywidgetsKernel;if(e.version){let n=new Promise(a=>{let c=()=>{if(window.vscIPyWidgets7)return a();setTimeout(c,500)};setTimeout(c,500)}),g=new Promise(a=>{let c=()=>{if(window.vscIPyWidgets8)return a();setTimeout(c,500)};setTimeout(c,500)});await Promise.all([n,g]);let p=()=>{try{window.vscIPyWidgets8.unload()}catch(a){}},f=()=>{try{window.vscIPyWidgets7.unload()}catch(a){}};e.version===7?(p(),window.vscIPyWidgets7.load(),r("Loaded IPYWidgets 7.x","info")):e.version===8&&(f(),window.vscIPyWidgets8.load(),r("Loaded IPYWidgets 8.x","info"))}e.widgetState&&d&&e.version?(await d.restoreWidgets(e.widgetState),s.resolve(Object.assign({},e,{widgetStateLoaded:!0}))):s.resolve(Object.assign({},e,{widgetStateLoaded:!1}))}});async function u(e){if(!t.postMessage)return{hasWidgetState:!1,kernelSelected:!1};let i=o.get(e)||y();return o.set(e,i),t.postMessage({command:"query-widget-state",model_id:e}),i.promise}return{async renderOutputItem(e,i,d){r(`Got item for Rendering ${e.id}}`);try{let n=_(e);if(!n)throw r(`Error: Model not found to render output ${e.id}`,"error"),new l;let g=I(),{hasWidgetState:p,kernelSelected:f}=await u(n.model_id),a=p&&f?await g:void 0;if(!p)throw r(`Model not found in Kernel state to render output ${e.id}, rendering a fallback mime type`,"info"),new l;if(!f)throw r(`No Kernel selected, hence not rendering widget output ${e.id}`,"error"),new l;if(a)return r(`Rendering ${e.id} widget renderer found *************`),i.className=(i.className||"")+" cell-output-ipywidget-background",a(e,n,i,r,u);throw new l}catch(n){throw w(`Failed to render output ${e.id}, ${n}`),n}finally{M(t,e,i)}},disposeOutputItem(e){var d,n;r(`Disposing rendered output for ${e}`);let i=((d=window.ipywidgetsKernel)==null?void 0:d.disposeOutput)||((n=this.ipywidgetsKernel)==null?void 0:n.disposeOutput);if(i)return i(e)}}};function D(t){let r=window;if(!r.widgetEntryPoint||typeof r.widgetEntryPoint.initialize!="function"){t.postMessage&&t.postMessage({command:"log",message:"Hook not registered"});return}r.widgetEntryPoint.initialize(t)}function M(t,r,o){let s=window;!s.widgetEntryPoint||typeof s.widgetEntryPoint.renderOutputItem!="function"||(t.postMessage&&t.postMessage({command:"log",message:"rendering output"}),s.widgetEntryPoint.renderOutputItem(r,o))}export{B as activate};
